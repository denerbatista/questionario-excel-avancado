<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Quiz Excel (estilo Kahoot)</title>
    <style>
      :root {
        --bg1: #46178f; /* roxo kahoot-like */
        --bg2: #8520e9;
        --card: #ffffff;
        --text: #1a1a1a;
        --muted: #6b6b6b;
        --ok: #22c55e;
        --err: #ef4444;
        --red: #e21b3c; /* ‚ñ≤ */
        --blue: #1368ce; /* ‚óÜ */
        --yellow: #ffa602; /* ‚óè */
        --green: #26890c; /* ‚ñ† */
      }

      html,
      body {
        height: 100%;
      }

      /* CORRIGIDO: remove o flex que cortava o relat√≥rio; permite rolagem da p√°gina */
      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,
          "Helvetica Neue", Arial;
        background: radial-gradient(
            1200px 700px at 20% -10%,
            var(--bg2),
            transparent
          ),
          radial-gradient(1200px 700px at 80% -10%, var(--bg1), transparent),
          linear-gradient(180deg, var(--bg1), var(--bg2));
        color: #fff;
        min-height: 100%;
        overflow-y: auto; /* permite rolar */
        padding: 24px;
        scroll-behavior: smooth;
      }

      /* ACRESCIDO: centraliza sem travar a altura */
      .app {
        width: min(900px, 100%);
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 24px;
        padding: 20px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.25);
        -webkit-backdrop-filter: blur(6px); /* Suporte Safari */
        backdrop-filter: blur(6px); /* Padr√£o */
      }

      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        margin-bottom: 12px;
      }
      .brand {
        font-weight: 800;
        letter-spacing: 0.5px;
      }
      .chip {
        background: rgba(255, 255, 255, 0.18);
        border-radius: 999px;
        padding: 6px 12px;
        font-size: 14px;
      }

      .card {
        background: var(--card);
        color: var(--text);
        border-radius: 20px;
        padding: 22px;
        margin-top: 10px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.18);
      }
      .qtext {
        font-size: clamp(18px, 2.4vw, 26px);
        font-weight: 700;
        line-height: 1.25;
      }
      .meta {
        color: var(--muted);
        font-size: 14px;
        margin-top: 6px;
      }

      .answers {
        display: grid;
        gap: 12px;
        margin-top: 18px;
      }
      @media (min-width: 680px) {
        .answers {
          grid-template-columns: 1fr 1fr;
        }
      }

      .btn {
        border: 0;
        border-radius: 16px;
        padding: 16px 14px;
        text-align: left;
        font-size: 16px;
        font-weight: 700;
        color: #fff;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 12px;
        min-height: 72px;
        box-shadow: 0 6px 0 rgba(0, 0, 0, 0.2),
          inset 0 -3px 0 rgba(0, 0, 0, 0.15);
        transition: transform 0.06s ease, filter 0.2s ease,
          box-shadow 0.06s ease;
      }
      .btn:active {
        transform: translateY(2px);
        box-shadow: 0 4px 0 rgba(0, 0, 0, 0.2),
          inset 0 -1px 0 rgba(0, 0, 0, 0.1);
      }
      .btn[disabled] {
        filter: grayscale(0.2) brightness(0.85);
        cursor: not-allowed;
      }

      .shape {
        font-size: 22px;
        line-height: 1;
        width: 28px;
        height: 28px;
        display: grid;
        place-items: center;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 6px;
      }
      .opt-red {
        background: var(--red);
      }
      .opt-blue {
        background: var(--blue);
      }
      .opt-yellow {
        background: var(--yellow);
        color: #222;
      }
      .opt-green {
        background: var(--green);
      }

      .feedback {
        margin-top: 14px;
        padding: 12px 14px;
        border-radius: 12px;
        font-weight: 700;
        display: none;
      }
      .feedback.ok {
        background: #e8fff1;
        color: #065f46;
        display: block;
      }
      .feedback.err {
        background: #ffecec;
        color: #7f1d1d;
        display: block;
      }

      .controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 16px;
      }
      .progress {
        height: 10px;
        border-radius: 999px;
        background: #eee;
        overflow: hidden;
        flex: 1;
        margin-right: 12px;
      }
      .bar {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #22c1c3, #fdbb2d);
        transition: width 0.35s ease;
      }

      .next {
        background: #111827;
        color: #fff;
        border: 0;
        border-radius: 999px;
        padding: 10px 16px;
        font-weight: 800;
        letter-spacing: 0.3px;
        cursor: pointer;
      }
      .next[disabled] {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* Resultados */
      .results h2 {
        margin: 0 0 6px 0;
      }
      .stats {
        display: flex;
        gap: 10px;
        margin: 8px 0 14px 0;
        flex-wrap: wrap;
      }
      .stat {
        background: rgba(255, 255, 255, 0.12);
        border: 1px solid rgba(255, 255, 255, 0.25);
        padding: 10px 12px;
        border-radius: 12px;
        font-weight: 700;
      }
      .list {
        margin-top: 1rem; /* ‚Üì antes 15rem */
        display: grid; /* grid √© melhor que flex p/ lista vertical */
        gap: 10px;
        max-height: 60vh; /* ‚Üì era min-height; use max para caber na tela */
        overflow: auto; /* rolagem s√≥ na lista */
        overscroll-behavior: contain;
      }

      .item {
        background: #fff;
        color: #222;
        border-radius: 14px;
        padding: 12px 14px;
        border-left: 6px solid #ddd;
      }
      .item.ok {
        border-left-color: var(--ok);
      }
      .item.err {
        border-left-color: var(--err);
      }
      .small {
        color: #666;
        font-size: 14px;
        margin-top: 6px;
      }
      .again {
        margin-top: 14px;
        background: #111827;
        color: #fff;
        border: 0;
        border-radius: 10px;
        padding: 12px 14px;
        font-weight: 800;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="app">
      <div class="header">
        <div class="brand">Quiz Excel ‚Ä¢ estilo Kahoot</div>
        <div class="chip" id="counter">Pergunta 1 de N</div>
      </div>

      <div class="card" id="stage">
        <!-- conte√∫do din√¢mico -->
      </div>
    </div>

    <script>
      /* ===================== DADOS ===================== */
      /* Perguntas originais (baseadas nos Kahoots usados em aula) */
      const rawQuestions = [
        {
          q: "Para padronizar o texto: <pre>'   Jo√£o   da   Silva  '<pre> para 'Jo√£o da Silva', qual fun√ß√£o do Excel voc√™ usaria?",
          options: ["MAI√öSCULA", "ARRUMAR", "PRI.MAI√öSCULA", "SUBSTITUIR"],
          correct: 1,
          explain:
            "ARRUMAR remove espa√ßos extras no meio e nas extremidades, mantendo apenas um espa√ßo entre palavras.",
        },
        {
          q: "Para transformar 'senai cepaf' em 'SENAI CEPAF', a fun√ß√£o correta √©:",
          options: ["PRI.MAI√öSCULA", "MIN√öSCULA", "MAI√öSCULA", "PRI.MIN√öSCULA"],
          correct: 2,
          explain: "MAI√öSCULA converte todo o texto para letras mai√∫sculas.",
        },
        {
          q: "Extrair 'CEP' de 'ES-CEP-2025' iniciando na 4¬™ posi√ß√£o e por 3 caracteres: que fun√ß√£o aplica?",
          options: ["ESQUERDA", "DIREITA", "EXT.TEXTO", "ARRUMAR"],
          correct: 2,
          explain:
            "EXT.TEXTO(texto; in√≠cio; n√∫m_caracteres) retorna um trecho do meio.",
        },
        {
          q: "Para pegar os 4 primeiros caracteres de 'ABCD1234', usamos:",
          options: ["DIREITA", "EXT.TEXTO", "ESQUERDA", "PRI.MAI√öSCULA"],
          correct: 2,
          explain: "ESQUERDA(texto; n) devolve os n primeiros caracteres.",
        },
        {
          q: "Sem f√≥rmula na c√©lula, que recurso destacaria automaticamente valores > 100 em vermelho?",
          options: [
            "Formata√ß√£o Condicional",
            "Tabela Din√¢mica",
            "Classifica√ß√£o",
            "Filtro Avan√ßado",
          ],
          correct: 0,
          explain:
            "A Formata√ß√£o Condicional aplica regras visuais conforme crit√©rios.",
        },
        {
          q: "Qual fun√ß√£o retorna VERDADEIRO somente se B2>0 e C2>0?",
          options: ["SE", "E", "OU", "SEERRO"],
          correct: 1,
          explain:
            "E(teste1; teste2; ...) s√≥ √© VERDADEIRO quando todos os testes forem verdadeiros.",
        },
        {
          q: "Qual fun√ß√£o retorna VERDADEIRO se B2>0 ou C2>0?",
          options: ["E", "SE", "SEERRO", "OU"],
          correct: 3,
          explain:
            "OU(teste1; teste2; ...) √© VERDADEIRO quando pelo menos um teste for verdadeiro.",
        },
        {
          q: "Se B2 ‚â• 7, retornar 'Aprovado'; caso contr√°rio, 'Reprovado'. Qual f√≥rmula est√° correta?",
          options: [
            '=SE(B2>=7;"Aprovado";"Reprovado")',
            '=SE(B2>=7;"Reprovado";"Aprovado")',
            '=SE(B2>7;"Aprovado")',
            '=SEERRO(B2>=7;"Aprovado")',
          ],
          correct: 0,
          explain:
            "A sintaxe do SE √© SE(teste_l√≥gico; valor_se_verdadeiro; valor_se_falso).",
        },
        {
          q: 'Somar C1:C10 somente quando A1:A10 = "Ma√ß√£" e B1:B10 = "ES". Qual fun√ß√£o usar?',
          options: ["SOMASE", "SOMASES", "SOMARPRODUTO", "CONT.SES"],
          correct: 1,
          explain: "SOMASES permite somar com dois ou mais crit√©rios.",
        },
        {
          q: "Quantas c√©lulas N√ÉO vazias existem em A1:A100? Qual fun√ß√£o conta isso?",
          options: ["CONT.VALORES", "CONT.SE", "CONT.N√öM", "CONTAR.VAZIO"],
          correct: 0,
          explain:
            "CONT.VALORES conta c√©lulas n√£o vazias (texto, n√∫mero, etc.).",
        },
        {
          q: "Para contar c√©lulas vazias em B1:B50, usamos:",
          options: ["CONTAR.VAZIO", "CONT.SE", "CONT.N√öM", "CONT.SES"],
          correct: 0,
          explain: "CONTAR.VAZIO retorna a quantidade de c√©lulas vazias.",
        },
        {
          q: "Contar apenas as c√©lulas com n√∫meros em D1:D20:",
          options: ["CONT.N√öM", "CONT.VALORES", "ORDEM.EQ", "M√âDIA"],
          correct: 0,
          explain: "CONT.N√öM conta somente c√©lulas com n√∫meros.",
        },
        {
          q: "Para retornar a posi√ß√£o (ranking) de E5 dentro do intervalo E1:E10, a fun√ß√£o √©:",
          options: ["RANK", "CLASSIFICAR", "ORDEM.EQ", "MENOR"],
          correct: 2,
          explain: "ORDEM.EQ retorna a posi√ß√£o do n√∫mero na lista.",
        },
        {
          q: "Multiplicar pares de valores (Pre√ßo √ó Quantidade) e somar os resultados de uma vez:",
          options: ["SOMASE", "SOMASES", "SOMARPRODUTO", "MULT"],
          correct: 2,
          explain:
            "SOMARPRODUTO soma produtos de elementos correspondentes em intervalos.",
        },
        {
          q: "Qual fun√ß√£o retorna o maior valor em F1:F10?",
          options: ["M√âDIA", "M√çN", "M√ÅXIMO", "SOMA"],
          correct: 2,
          explain: "M√ÅXIMO devolve o maior n√∫mero de um intervalo.",
        },
        {
          q: "Sobre datas: qual fun√ß√£o retorna a data de hoje (do sistema)?",
          options: ["DATA", "HOJE", "AGORA", "DIA"],
          correct: 1,
          explain: "HOJE() retorna somente a data atual.",
        },
        {
          q: "Se hoje √© 15/03/2025, qual resultado de =ANO(HOJE())?",
          options: ["03", "15", "2025", "1"],
          correct: 2,
          explain: "ANO(data) devolve o ano (2025).",
        },
        {
          q: "Qual fun√ß√£o retorna o n√∫mero do dia da semana (1‚Äì7) para uma data?",
          options: ["DIA.DA.SEMANA", "DIA", "M√äS", "HORA"],
          correct: 0,
          explain:
            "DIA.DA.SEMANA(data; [tipo]) retorna 1‚Äì7 conforme a configura√ß√£o.",
        },
        {
          q: "Para extrair a hora de um hor√°rio em c√©lula (ex.: 14:35:20), usamos:",
          options: ["MINUTO", "SEGUNDO", "HORA", "AGORA"],
          correct: 2,
          explain: "HORA(hor√°rio) devolve a parte da hora.",
        },
        {
          q: "Para avan√ßar 5 DIAS √öTEIS a partir de hoje, qual fun√ß√£o retorna a nova data?",
          options: ["DIAS", "DIATRABALHO.INTL", "DATA", "SOMASES"],
          correct: 1,
          explain:
            "DIATRABALHO.INTL(data_inicial; dias_√∫teis; [fim_de_semana; feriados]) pula fins de semana/feriados.",
        },
      ];

      /* ====== Pequenos utilit√°rios ====== */
      function shuffle(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      }
      function prepare(questions) {
        // (Opcional) embaralha op√ß√µes preservando √≠ndice correto
        return questions.map((q) => {
          const map = q.options.map((opt, idx) => ({ opt, idx }));
          shuffle(map);
          const options = map.map((m) => m.opt);
          const correct = map.findIndex((m) => m.idx === q.correct);
          return { ...q, options, correct };
        });
      }

      /* ====== Estado ====== */
      const QUESTIONS = prepare(rawQuestions);
      let i = 0;
      let results = []; // {q, options, picked, correct}

      /* ====== Renderiza√ß√£o ====== */
      const stage = document.getElementById("stage");
      const counter = document.getElementById("counter");

      function renderQuestion() {
        const total = QUESTIONS.length;
        counter.textContent = `Pergunta ${i + 1} de ${total}`;

        const { q, options } = QUESTIONS[i];

        stage.innerHTML = `
    <div class="qtext">${q}</div>
    <div class="meta">Escolha uma alternativa. A corre√ß√£o √© imediata.</div>

    <div class="answers" id="answers"></div>

    <div id="feedback" class="feedback"></div>

    <div class="controls">
      <div class="progress"><div class="bar" id="bar" style="width:${
        (i / total) * 100
      }%"></div></div>
      <button id="next" class="next" disabled>Pr√≥xima ‚ñ∂</button>
    </div>
  `;

        const answersEl = document.getElementById("answers");
        const palette = ["opt-red", "opt-blue", "opt-yellow", "opt-green"];
        const symbols = ["‚ñ≤", "‚óÜ", "‚óè", "‚ñ†"];

        options.forEach((text, k) => {
          const btn = document.createElement("button");
          btn.className = `btn ${palette[k % 4]}`;
          btn.innerHTML = `<span class="shape">${
            symbols[k % 4]
          }</span> <span>${text}</span>`;
          btn.addEventListener("click", () => checkAnswer(k, btn));
          answersEl.appendChild(btn);
        });

        document.getElementById("next").addEventListener("click", nextQuestion);
      }

      function checkAnswer(pickedIndex, btnEl) {
        // desabilitar tudo
        const buttons = [...document.querySelectorAll(".btn")];
        buttons.forEach((b) => (b.disabled = true));

        const qobj = QUESTIONS[i];
        const isCorrect = pickedIndex === qobj.correct;

        // marcar cores
        if (isCorrect) {
          btnEl.style.outline = `4px solid var(--ok)`;
        } else {
          btnEl.style.outline = `4px solid var(--err)`;
          // destacar correta
          buttons[qobj.correct].style.outline = `4px solid var(--ok)`;
        }

        // feedback
        const fb = document.getElementById("feedback");
        fb.className = `feedback ${isCorrect ? "ok" : "err"}`;
        fb.textContent = isCorrect ? "‚úÖ Correto!" : `‚ùå Ops, n√£o √© essa.`;
        fb.insertAdjacentHTML(
          "beforeend",
          `<div class="small">Dica: ${qobj.explain}</div>`
        );

        // salvar resultado
        results.push({
          q: qobj.q,
          options: qobj.options,
          picked: pickedIndex,
          correct: qobj.correct,
        });

        // liberar pr√≥xima
        document.getElementById("next").disabled = false;
      }

      function nextQuestion() {
        const total = QUESTIONS.length;
        if (i < total - 1) {
          i++;
          renderQuestion();
        } else {
          renderResults();
        }
      }

      function renderResults() {
        const total = QUESTIONS.length;
        const hits = results.filter((r) => r.picked === r.correct).length;
        const misses = total - hits;
        const pHit = Math.round((hits / total) * 100);
        const pMiss = 100 - pHit;

        document.querySelector(".header .chip").textContent = "Resultado";
        stage.innerHTML = `
    <div class="results">
      <h2>Seu desempenho</h2>
      <div class="stats">
        <div class="stat">Acertos: ${hits}/${total} (${pHit}%)</div>
        <div class="stat">Erros: ${misses}/${total} (${pMiss}%)</div>
      </div>
      <div class="list" id="list"></div>
      <button class="again" id="again">üîÅ Refazer quiz</button>
    </div>
  `;

        const list = document.getElementById("list");
        results.forEach((r, idx) => {
          const ok = r.picked === r.correct;
          const your = r.options[r.picked] ?? "(sem resposta)";
          const right = r.options[r.correct];
          const el = document.createElement("div");
          el.className = `item ${ok ? "ok" : "err"}`;
          el.innerHTML = `
      <div><strong>${idx + 1}.</strong> ${r.q}</div>
      <div class="small">${
        ok ? "‚úÖ Acertou" : "‚ùå Errou"
      } ‚Äî Sua resposta: <em>${your}</em> ‚Ä¢ Correta: <strong>${right}</strong></div>
    `;
          list.appendChild(el);
        });

        document.getElementById("again").addEventListener("click", () => {
          i = 0;
          results = [];
          renderQuestion();
        });

        // barra completa (cosm√©tico)
        const fakeBar = document.createElement("div");
        fakeBar.className = "bar";
        fakeBar.style.width = "100%";
        const prog = document.createElement("div");
        prog.className = "progress";
        prog.appendChild(fakeBar);
        stage.prepend(prog);

        // NOVO: garante que o topo do relat√≥rio apare√ßa
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      /* start */
      renderQuestion();
    </script>
  </body>
</html>
